
<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="../sakura.css" />
    <title>WebUSB DFU</title>
    <script src="dfu.js"></script>
    <script src="dfuse.js"></script>
    <script src="FileSaver.js"></script>
    <script src="dfu-util.js"></script>
    <style>
      p.warning {
        color: red;
      }
      p.error {
        color: red;
        font-weight: bold;
      }
      label.radio {
        display: inline;
      }
      input:invalid {
        color:red;
      }
    </style>
  </head>
  <body>
    <table>
      <tr>
        <td colspan=2 id="statusField" style="background:tom">
          <p style="text-align: center;"><span id="status"></span></p>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <button id="connect">Connect</button>
        </td>
        <td>
          <div id="connectMessage">
            <p>Press and hold the programm button on device.
            Then plug the USB cable on it. 
            Then, click on the "Connect" button</p>
          </div>
        </td>
      </tr>
      <tr>
        <td style="text-align: center;">
          <button id="download" disabled="true">Flash</button>
        </td>
        <td>
          <div class="log" id="downloadLog"></div>
        </td>
      </tr>
    </table>


    <dialog id="interfaceDialog">
      Your device has multiple DFU interfaces. Select one from the list below:
      <form id="interfaceForm" method="dialog">
        <button id="selectInterface" type="submit">Select interface</button>
      </form>
    </dialog>

    <fieldset>


      <form id="configForm">
        <!-- <label for="transferSize">Transfer Size:</label> -->
        <input type="number" name="transferSize" id="transferSize" value="1024" hidden="true"/>
        <div id="dfuseFields" hidden="true">
          <label for="dfuseStartAddress">DfuSe Start Address:</label>
          <input type="text" name="dfuseStartAddress" id="dfuseStartAddress" title="Initial memory address to read/write from (hex)" size="10" pattern="0x[A-Fa-f0-9]+"/>
          <label for="dfuseUploadSize">DfuSe Upload Size:</label>
          <input type="number" name="dfuseUploadSize" id="dfuseUploadSize" min="1"/>
        </div>
      
      </form>
  
    <h1>About</h1>
    
    <h1>Prerequisites</h1>
    <p>In order to flash the device, you will need:</p>
    <ul>
      <li>
        <p>An up-to-date version of Chrome, at least version 61 or newer</p>
      </li>
      <li>
        <p>Press and hold the program button on the device while plugin its USB connector</p>
      </li>
    </ul>
    <p>On windows you may need to change the virtual com port drives on your PC for the above to work.</p>
    <p>Fortunately there is a great piece of software called Zadig which you need to download and install onto your PC</p>
    <p>download Zadig <a href="http://zadig.akeo.ie/">here</a> </p>
    <ul>
      <li>
        <p>Download and Intall Zadig
      </li>
      <li>
        <p>Press and hold the program button on the device while plugin its USB connector</p>
      </li>
      <li>
        <p>Open Zadig, choose Options > List All Devices</p>
      </li>
      <li>
        <p>Select STM32 Bootloader, WinUSB</p>
      </li>
      <li>
        <p>Click "replace driver" or "install driver"</p>
      </li>
      <li>
        <p>Restart the firmware upgrade procedure</p>
      </li>
    </ul>
    </fieldset>
    <fieldset>
      <p>Release notes</p>
      <li>1
        <p>Initial release</p>
      </li>
      
      <li>1.2
        <p>Support for Spark Turbines</p>
      </li>
      <li>1.2.1 - March 2020
        <p>Bug correction. Evojet Fuel calculation</p>
      </li>
    </fieldset>
  </body>
</html>
